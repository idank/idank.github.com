<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
  <link href='http://fonts.googleapis.com/css?family=Cantarell' rel='stylesheet' type='text/css'>
  <meta http-equiv="X-UA-Compatible" content="">
  <title>kth smallest element in union of sorted arrays - aleph.nu</title>
  <meta name="description" content="refresh browser when html or css changes
">
  <meta name="author" content="Idan Kamara">

    <link rel="shortcut icon" href="/favicon.png">
  
    <link rel="stylesheet" href="/media/css/site.css">
  
  
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28052058-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  
    </head>
<body id="kth-smallest-in-sorted-union">
  <div id="container">
            <div id="header">
          <img src="/media/images/aleph.png" height="120"/>
                      <ul id="navigation">
                          <li>
                <a title="Home Page" class="" href="/">
                    Home
                </a>
              </li>              <li>
                <a title="University" class="" href="/university.html">
                    University
                </a>
              </li>              <li>
                <a title="About" class="" href="/about.html">
                    About
                </a>
              </li>            </ul>          <div><h2 id="site-title"><span>Aleph.Nu</span><span id="title-suffix">ll</span></h2></div>
      </div> <!--! end of #header -->
                  <div class="content">
          <div class="title">
                <h2>kth smallest element in union of sorted arrays</h2>
    
    <ul class="footer">
            <li class="tags">
            <ul>
                            <li>
                    <a class="small" href="/blog/tags/algorithms.html">algorithms</a>
                </li>
                        </ul>
        </li>
                    <li class="date"><abbr class="timeago" title="2011-12-08 12:25:00">08 Dec 2011</abbr>, 08 Dec 2011
</li>
    </ul>
</div>

<blockquote>
Given two sorted arrays A and B of length n, find the kth smallest element in the union of the two arrays (imagine the two arrays are merged into one sorted array of length 2n). Do so in $ \Theta (\lg n) $.</blockquote>

<p>If we pick two elements, $A[i]$ and $B[j]$, and look at the bigger of the two, let it be $A[i]$, we know that it is <strong>at least</strong> the $i+j$ smallest element in $A \cup B$. Why? Because it is bigger than everything in $A[1..i-1]$ and $B[1..j]$, and the amount of elements in those two is equal to&nbsp;$i+j$.</p>
<p>What about the smaller of the two, $B[j]$? We can say that it&#8217;s <strong>at most</strong> the $i+j-1$ smallest element in $A \cup B$. Why? Because $A[i+1..n], B[j..n]$ are all bigger than&nbsp;it.</p>
<p>Now if $k &lt; i+j$, we can say for sure that our $k$th smallest element is not $A[i]$ or any of A&#8217;s elements after it. Similarly, if $k \geq i+j$, that rules out&nbsp;$B[1..j]$.</p>
<p>We start at $A[\lfloor \frac{n}{2} \rfloor], B[\lfloor \frac{n}{2} \rfloor]$, and depending on who&#8217;s bigger, we use the above observations to rule out either the bottom or top half of one of the arrays. If we rule the top of an array, we go back to our original problem only one of the arrays has shrunk in half. If we rule out the bottom, we now have to find the $(k-$ number of elements thrown$)$ smallest element in the halved array and the untouched&nbsp;one.</p>
<p>We are done when one of the arrays is empty, then we simply return the $k$th element in the other&nbsp;one.</p>
<p>It should be fairly obvious why this takes $\Theta (\lg n)$. At each step of the algorithm we do a constant amount of work, and our recursion call loses half an array (similar to binary&nbsp;search).</p>      </div>
      </div> <!--! end of #container -->
  <div id="footer">
  </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
  <script>window.jQuery || document.write('<script src="/media/js/libs/jquery-1.5.1.min.js">\x3C/script>')</script>
  <script src="/media/js/libs/jquery.timeago.js" type="text/javascript"></script>
  <script>
      jQuery(document).ready(function() {
        jQuery("abbr.timeago").timeago();
      });
  </script>
    <script src="/media/js/libs/highlight.pack.js" type="text/javascript"></script>
<script type="text/javascript">
        hljs.initHighlightingOnLoad();
</script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  </body>
</html>